{% extends "base.html" %}
{% block content %}
<div class="container">
  <h2>{{ auction.game.title }}</h2>
  <img src="{{ auction.game.image or url_for('static', filename='img/placeholder.png') }}" 
       alt="Capa do jogo {{ auction.game.title }}" style="max-width:200px;">
  <p><strong>Plataforma:</strong> {{ auction.game.platform }}</p>
  <p><strong>Descrição:</strong> {{ auction.game.description }}</p>
  <p><strong>Preço atual:</strong> R$ {{ auction.current_price }}</p>
  <p><strong>Término:</strong> {{ auction.end_time.strftime('%d/%m/%Y %H:%M') }}</p>

  {% if session.get('user_id') %}
  <form method="post" action="{{ url_for('place_bid') }}" onsubmit="return validateBid(this)">
    <input type="hidden" name="auction_id" value="{{ auction.id }}">
    <input type="hidden" name="current_price" value="{{ auction.current_price }}">
    <input type="number" step="0.01" name="amount" placeholder="Seu lance" required>
    <button type="submit" class="btn btn-cta">Dar lance</button>
  </form>
  {% else %}
  <p><a href="{{ url_for('login') }}">Faça login</a> para dar um lance.</p>
  {% endif %}

  <h3>Lances Recentes</h3>
  <ul>
    {% for bid in bids %}
    <li><strong>{{ bid.bidder.username }}</strong>: R$ {{ bid.amount }} ({{ bid.placed_at.strftime('%d/%m %H:%M') }})</li>
    {% else %}
    <li>Sem lances ainda.</li>
    {% endfor %}
  </ul>
</div>
{% endblock %}
