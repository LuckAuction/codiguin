{% extends "base.html" %}
{% block content %}

<div class="auction-container">

  <div class="auction-card">

    <div class="auction-header">
      <h2 class="game-title">{{ auction.game.title }}</h2>
    </div>

    <div class="auction-body">

      <div class="game-info">
        <img class="game-cover"
          src="{{ auction.game.image or url_for('static', filename='img/placeholder.png') }}"
          alt="Capa do jogo {{ auction.game.title }}">
        
        <div class="details">
          <p><strong>ğŸ® Plataforma:</strong> {{ auction.game.platform }}</p>
          <p><strong>ğŸ“„ DescriÃ§Ã£o:</strong> {{ auction.game.description }}</p>
          <p><strong>ğŸ’° PreÃ§o atual:</strong> <span class="price">R$ {{ auction.current_price }}</span></p>
          <p><strong>â° Termina em:</strong> {{ auction.end_time.strftime('%d/%m/%Y %H:%M') }}</p>
        </div>
      </div>

      <hr>

      {% if session.get('user_id') %}
      <form class="bid-form" method="post" action="{{ url_for('place_bid') }}" onsubmit="return validateBid(this)">
        <input type="hidden" name="auction_id" value="{{ auction.id }}">
        <input type="hidden" name="current_price" value="{{ auction.current_price }}">

        <label for="amount">Seu lance:</label>
        <input type="number" step="0.01" name="amount" id="amount" class="input-bid" placeholder="Digite seu lance" required>

        <button type="submit" class="btn btn-cta">Dar lance ğŸš€</button>
      </form>
      {% else %}
      <p class="login-warning">
        <a href="{{ url_for('login') }}">FaÃ§a login</a> para dar um lance.
      </p>
      {% endif %}

      <h3 class="section-title">ğŸ“¢ Lances Recentes</h3>

      <ul class="bids-list">
        {% for bid in bids %}
        <li class="bid-item">
          <strong>{{ bid.bidder.username }}</strong> â†’  
          <span class="bid-amount">R$ {{ bid.amount }}</span>
          <span class="bid-time">({{ bid.placed_at.strftime('%d/%m %H:%M') }})</span>
        </li>
        {% else %}
        <li class="no-bids">Nenhum lance foi registrado ainda.</li>
        {% endfor %}
      </ul>

    </div>

  </div>

</div>

{% endblock %}
